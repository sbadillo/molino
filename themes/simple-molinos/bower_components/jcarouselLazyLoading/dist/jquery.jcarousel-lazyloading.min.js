!function(t){"use strict";t.jCarousel.isImagesLoaded=function(n){function i(t){return t.complete?"undefined"!=typeof t.naturalWidth&&0===t.naturalWidth?!1:!0:!1}var e=n.find("img"),s=e.length,o=0;return t.each(e,function(){i(this)&&o++}),o===s},t.jCarousel.plugin("jcarouselLazyLoading",{_options:{preventScroll:!0,waitFunction:function(n,i,e){function s(){o++,t.jCarousel.isImagesLoaded(n)?(i(),a.removeClass("loading")):100>=o?setTimeout(s,100):(i(),a.removeClass("loading"))}var o=0,a=n.find("img[data-src]");a.toggleClass("non-transition",!!e),a.each(function(){var n=t(this),i=n.attr("data-src");n.addClass("loading"),n.attr("src",i).removeAttr("data-src")}),s()}},_scrollPrevented:!1,_position:0,_init:function(){var n=this;this._instance=this.carousel().data("jcarousel"),this._element.on("jcarousel:reloadend.jcarouselLazyLoading",function(){n._reload()}).on("jcarousel:scroll.jcarouselLazyLoading",function(i,e,s,o){var a=n._position!==n._instance.list().position()[n._instance.lt];if(!n._scrollPrevented&&!a&&n._options.preventScroll){var r=n._getNextVisibleSlides(s),c=function(){};n._scrollPrevented=!0,t.isFunction(o)&&(c=o,o=!0),n._options.waitFunction(r,function(){n._instance.scroll(s,o,function(){c(),n._scrollPrevented=!1})},!0),i.preventDefault()}}).on("jcarousel:scrollend.jcarouselLazyLoading",function(){var t=n._position!==n._instance.list().position()[n._instance.lt];(t||!n._options.preventScroll)&&n._options.waitFunction(n._instance.visible(),function(){})}).on("jcarousel:animateend.jcarouselLazyLoading",function(){n._position=n._instance.list().position()[n._instance.lt]})},_create:function(){this._reload()},_getNextVisibleSlides:function(t){var n,i,e,s,o,a=this._instance.clipping(),r=this._instance.items().length,c=0;for(s=this._getSlide(t),n=this._instance.dimension(s),e=s,o=s.index(),i=o+1>=r;a>n;)"circular"!==this._instance._options.wrap&&i?(c>0&&(c=0),c--):(c++,i=o+c+1>=r),s=this._getSlide(o+c),n+=this._instance.dimension(s),e=e.add(s);return e},_getSlide:function(n){var i,e=t.jCarousel.parseTarget(n),s=this._instance.items().length;return e.relative?(i=this._instance.index(this._instance.target()),this._instance.items().eq((i+e.target)%s)):"number"==typeof e.target?this._instance.items().eq(e.target%s):e.target},_destroy:function(){this._element.off(".jcarouselLazyLoading")},_reload:function(){this._options.waitFunction(this._instance.visible(),function(){}),this._position=this._instance.list().position()[this._instance.lt]}})}(jQuery);